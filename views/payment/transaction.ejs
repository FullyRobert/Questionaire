<!DOCTYPE html>
<html lang="en" data-textdirection="ltr" class="loading">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
  <meta name="description" content="Robust admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
  <meta name="keywords" content="admin template, robust admin template, dashboard template, flat admin template, responsive admin template, web app">
  <meta name="author" content="PIXINVENT">
  <title>我的订单</title>
  <link rel="apple-touch-icon" sizes="60x60" href="../app-assets/images/ico/apple-icon-60.png">
  <link rel="apple-touch-icon" sizes="76x76" href="../app-assets/images/ico/apple-icon-76.png">
  <link rel="apple-touch-icon" sizes="120x120" href="../app-assets/images/ico/apple-icon-120.png">
  <link rel="apple-touch-icon" sizes="152x152" href="../app-assets/images/ico/apple-icon-152.png">
  <link rel="shortcut icon" type="image/x-icon" href="../app-assets/images/ico/favicon.ico">
  <link rel="shortcut icon" type="image/png" href="../app-assets/images/ico/favicon-32.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-touch-fullscreen" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <!-- BEGIN VENDOR CSS-->
  <link rel="stylesheet" type="text/css" href="../app-assets/css/bootstrap.css">
  <!-- font icons-->
  <link rel="stylesheet" type="text/css" href="../app-assets/fonts/icomoon.css">
  <link rel="stylesheet" type="text/css" href="../app-assets/fonts/flag-icon-css/css/flag-icon.min.css">
  <link rel="stylesheet" type="text/css" href="../app-assets/vendors/css/extensions/pace.css">
  <!-- END VENDOR CSS-->
  <!-- BEGIN ROBUST CSS-->
  <link rel="stylesheet" type="text/css" href="../app-assets/css/bootstrap-extended.css">
  <link rel="stylesheet" type="text/css" href="../app-assets/css/app.css">
  <link rel="stylesheet" type="text/css" href="../app-assets/css/colors.css">
  <!-- END ROBUST CSS-->
  <!-- BEGIN Page Level CSS-->
  <link rel="stylesheet" type="text/css" href="../app-assets/css/core/menu/menu-types/vertical-menu.css">
  <link rel="stylesheet" type="text/css" href="../app-assets/css/core/menu/menu-types/vertical-overlay-menu.css">
  <link rel="stylesheet" type="text/css" href="../app-assets/vendors/css/documentation.css">
  <!-- END Page Level CSS-->
  <!-- BEGIN Custom CSS-->
  <link rel="stylesheet" type="text/css" href="../../../assets/css/style.css">
  <!-- END Custom CSS-->
  <style type="text/css">
    .cursor {
      cursor: pointer;
    }
  </style>>
</head>


<body data-open="click" data-menu="vertical-menu" data-col="2-columns" class="vertical-layout vertical-menu 2-columns  fixed-navbar">
  <!-- - var navbarCustom = "navbar-fixed-top navbar-semi-dark navbar-shadow"-->
  <!-- navbar-fixed-top-->
  <nav class="header-navbar navbar navbar-with-menu navbar-fixed-top navbar-semi-dark navbar-shadow">
    <div class="navbar-wrapper">
      <div class="navbar-header">
        <ul class="nav navbar-nav">
          <li class="nav-item"><a href="/book/bookhome" class="navbar-brand nav-link">在线支付系统</a></li> 
          <li class="nav-item hidden-md-up float-xs-right"><a data-toggle="collapse" data-target="#navbar-mobile" class="nav-link open-navbar-container"><i class="icon-ellipsis pe-2x fa-rotate-90"></i></a></li>
        </ul>
      </div>
      <div class="navbar-container content">
        <div id="navbar-mobile" class="collapse navbar-toggleable-sm">
          <ul class="nav navbar-nav">
            <li class="nav-item hidden-sm-down"><a class="nav-link nav-menu-main menu-toggle hidden-xs"><i class="icon-menu5"></i></a></li>
          </ul>
          <ul class="nav navbar-nav float-xs-right">
            <li class="nav-item"><a href="/logout" class="btn btn-success btn-doc-header"><i class="icon-bag3"></i>退出</a></li>
            <li class="nav-item"><a href="/account/balance" class="btn btn-success btn-doc-header"><i class="icon-bag3"></i>我的</a></li>
          </ul>
        </div>
      </div>
    </div>
  </nav>

  <!-- ////////////////////////////////////////////////////////////////////////////-->


  <!-- main menu-->
  <div data-scroll-to-active="true" class="main-menu menu-fixed menu-dark menu-accordion menu-shadow">
    <!-- main menu header-->
    <!-- / main menu header-->
    <!-- main menu content-->
    <div class="main-menu-content menu-accordion">
      <ul id="main-menu-navigation" data-menu="menu-navigation" class="navigation navigation-main">
        <li class=" nav-item">
          <a href="/account/balance"><i class="icon-home3"></i><span data-i18n="" class="menu-title">我的账户</span></a>
        </li>
        <li class="nav-item"><a href="/book/hotel_hotelsearch"><i class="icon-android-menu"></i><span data-i18n="" class="menu-title">在线预定</span></a>
        </li>
        <li class="active"><a href=""><i class="icon-folder3"></i><span data-i18n="" class="menu-title">我的订单</span></a>
        </li>
      </ul>
    </div>
    <!-- /main menu content-->
    <!-- main menu footer-->
    <!-- main menu footer-->
  </div>
  <!-- / main menu-->
  <!-- ////////////////////////////////////////////////////////////////////////////-->
  <div class="app-content content container-fluid">
    <div class="content-wrapper">
      <div class="content-header row">
        <div class="content-header-left col-md-10 col-xs-12 mb-1">
          <ul class="nav nav-tabs nav-left" style="height: 50px;">
            <li class="nav-item">
              <a class="text-success nav-link" id="baseVerticalLeft-tab6" href="/payment?selector=6">全部订单</a>
            </li>
            <li class="nav-item hidden-xs">
              <a class="text-success nav-link" id="baseVerticalLeft-tab0" href="/payment?selector=0">待付款</a>
            </li>
            <li class="nav-item">
              <a class="text-success nav-link" id="baseVerticalLeft-tab1" href="/payment?selector=1">待发货</a>
            </li>
            <li class="nav-item">
              <a class="text-success nav-link" id="baseVerticalLeft-tab2" href="/payment?selector=2">待收货</a>
            </li>
            <li class="nav-item">
              <a class="text-success nav-link" id="baseVerticalLeft-tab3" href="/payment?selector=3">已完成</a>
            </li>
            <li class="nav-item">
              <a class="text-success nav-link" id="baseVerticalLeft-tab4" href="/payment?selector=4">退款中</a>
            </li>
            <li class="nav-item">
              <a class="text-success nav-link" id="baseVerticalLeft-tab5" href="/payment?selector=5">已关闭</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">时间范围</a>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="/payment?selector=<%= selector %>" >所有</a>
                <a class="dropdown-item" href="/payment?selector=<%= selector %>&timerange=1">今天</a>
                <a class="dropdown-item" href="/payment?selector=<%= selector %>&timerange=2">本周</a>
                <a class="dropdown-item" href="/payment?selector=<%= selector %>&timerange=3">本月</a>
                <a class="dropdown-item" href="/payment?selector=<%= selector %>&timerange=4">近三年月</a>
                <a class="dropdown-item" href="/payment?selector=<%= selector %>&timerange=5">今年</a>
                <a class="dropdown-item" href="/payment?selector=<%= selector %>&timerange=6">更早</a>
              </div>
            </li>
          </ul>
        </div>
        <div class="content-header-right breadcrumbs-right breadcrumbs-top col-md-2 col-xs-12">
          <div class="breadcrumb-wrapper col-xs-12">
            <ol class="breadcrumb">
              <li class="breadcrumb-item active">订单总数：<%= length %>条</li>
            </ol>
          </div>
        </div>
      </div>
      <div class="content-body"><!-- Overview -->
        <% if (length == 0) { %>
          <div class="card-block">
            <div class="row">
                <div class="alert alert-info alert-dismissible fade in mb-2" role="alert">
                  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <strong>提示：这里一条记录也没有哦！</strong>
                </div>
            </div>
          </div>
        <% } %>
        <% for (var i = 0; i < details.length; i++) { %>
          <div class="card">
            <div class="card-header">
              <h4 class="card-title"><%= details[i].seller_name %></h4>
              <div class="heading-elements">
                <ul class="list-inline mb-0">
                  <% if (details[i].current_status == 0) {%>
                    <li>待付款&nbsp &nbsp &nbsp</li>
                  <% } else if (details[i].current_status == 1) { %>
                    <li>待发货&nbsp &nbsp &nbsp</li>
                  <% } else if (details[i].current_status == 2) { %>
                    <li>待收货&nbsp &nbsp &nbsp</li>
                  <% } else if (details[i].current_status == 3) { %>
                    <li>已完成&nbsp &nbsp &nbsp</li>
                  <% } else if (details[i].current_status == 4) { %>
                    <li>退款中&nbsp &nbsp &nbsp</li>
                  <% } else if (details[i].current_status == 5) { %>
                    <li>已关闭&nbsp &nbsp &nbsp</li>
                  <% } %>
                  <a href="/payment/orderinfo?oid=<%= compileStr('YCJ20190608' + details[i].order_id) %>&session=<%= compileStr('YCJ20190608' + i) %>" ><span class="tag tag-pill tag-default">查看详情</span></a>
                </ul>
              </div>
            </div>
            <div class="card-body collapse in" aria-expanded="true">
              <div class="card-block">
                <div class="table-responsive" >
                  <table class="table table-hover table-striped">
                    <tbody>
                      <th>订单号</th>
                      <th>订单内容</th>
                      <th class="hidden-xs">订单价格</th>
                      <th>下单时间</th>
                      <th>买方</th>
                      <th>卖方</th>
                      <tr>
                        <td><%= details[i].order_id %></td>
                        <td><%= details[i].goods_name %></td>
                        <td class="hidden-xs"><%= details[i].price %></td>
                        <td><%= dateFormat(details[i].created_time) %></td>
                        <td><%= username %></td>
                        <td><%= details[i].seller_name %></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            <div class="card-footer border-top-blue-grey border-top-lighten-5 text-muted">
              <span class="tags float-xs-right">
                <% if (details[i].current_status == 0) { %>
                  <a href="/payment/orderinfo?oid=<%= compileStr('YCJ20190608' + details[i].order_id) %>&session=<%= compileStr('YCJ20190608' + i) %>" style="float: left">
                    <span class="tag tag-pill tag-success">前往付款</span>
                  </a>
                  <form action="/payment/cancelOrder" method="post" style="float: right;">
                    <span class="tag tag-pill tag-warning cursor cancel_order">取消订单</span>
                    <input type="hidden" name="pos" value="<%= i %>" />
                  </form>
                <% } %>
                <% if (details[i].current_status == 2) { %>
                  <form action="/payment/confirmReceived" method="post">
                    <span class="tag tag-pill tag-success cursor confirm_received">确认收货</span>
                    <input type="hidden" name="pos" value="<%= i %>" />
                  </form>
                <% } %>
                <% if (details[i].current_status == 3) { %>
                  <a href="/payment/orderinfo?oid=<%= compileStr('YCJ20190608' + details[i].order_id) %>&session=<%= compileStr('YCJ20190608' + i) %>"><span class="tag tag-pill tag-info">申请退款</span></a>
                <% } %>
                <% if (details[i].current_status == 4) { %>
                  <form action="/payment/cancelRefund" method="post">
                    <span class="tag tag-pill tag-danger cursor cancel_refund">取消退款</span>
                    <input type="hidden" name="pos" value="<%= i %>" />
                  </form>
                <% } %>
              </span>
            </div>
          </div>
        <% } %>
      </div>
    

    <!-- BEGIN VENDOR JS-->
    <script src="../app-assets/js/core/libraries/jquery.min.js" type="text/javascript"></script>
    <script src="../app-assets/vendors/js/ui/tether.min.js" type="text/javascript"></script>
    <script src="../app-assets/js/core/libraries/bootstrap.min.js" type="text/javascript"></script>
    <script src="../app-assets/vendors/js/ui/perfect-scrollbar.jquery.min.js" type="text/javascript"></script>
    <script src="../app-assets/vendors/js/ui/unison.min.js" type="text/javascript"></script>
    <script src="../app-assets/vendors/js/ui/blockUI.min.js" type="text/javascript"></script>
    <script src="../app-assets/vendors/js/ui/jquery.matchHeight-min.js" type="text/javascript"></script>
    <script src="../app-assets/vendors/js/ui/screenfull.min.js" type="text/javascript"></script>
    <script src="../app-assets/vendors/js/extensions/pace.min.js" type="text/javascript"></script>
    <!-- BEGIN VENDOR JS-->
    <!-- BEGIN PAGE VENDOR JS-->
    <!-- END PAGE VENDOR JS-->
    <!-- BEGIN ROBUST JS-->
    <script src="../app-assets/js/core/app-menu.js" type="text/javascript"></script>
    <script src="../app-assets/js/core/app.js" type="text/javascript"></script>
    <!-- END ROBUST JS-->
    <!-- BEGIN PAGE LEVEL JS-->
    <script src="../app-assets/js/scripts/documentation.js" type="text/javascript"></script>
    <script src="../app-assets/vendors/js/ui/affix.js" type="text/javascript"></script>
    <!-- END PAGE LEVEL JS-->

    <!--   [注]：实际使用时要把这段js代码藏好！虽然我在后端进行了二次检测数据是否被篡改。 -->
    <script type="text/javascript">
      $(function(){
        $("#baseVerticalLeft-tab<%= selector %>").addClass("active");
      });
      $(".cancel_order").click(function(){
        if (confirm("确认取消订单吗，一旦取消将不可恢复！")) {
          $(this).parents("form").submit();
        }
      });
      $(".cancel_refund").click(function(){
        if (confirm("确认取消退款吗？")) {
          $(this).parents("form").submit();
        }
      });
      $(".confirm_received").click(function(){
        if (confirm("确认收货吗？")) {
          $(this).parents("form").submit();
        }
      });
    </script>
    <!-- 这段js代码放这主要是为了方便大家参考逻辑 -->

  </body>
  </html>